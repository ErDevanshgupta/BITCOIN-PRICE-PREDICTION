%MAX Z=2X1+5X2
%X1+4X2<=24
%3X1+X2<=21
%X1+X2<=9
%X1,X2>=0

clc
clear all
a=[1 4;3 1;1 1]
b=[24;21;9]
S=eye(size(a,1))
C=[2 5]
A=[a S b] %complete table
n=size(a,2) %no of variables

cost=zeros(1,size(A,2)) %phle cost 0 hoga sbka 1 row X no of columns in A matrix
cost(1:n)=C %jitne variables the x1,x2 unka cost toh C hua na ,,,,ab update kr dia cost wla vector ko

bv=n+1:size(A,2)-1 %s1,s2,s3 basically so n+1 means x2 ke baad se and size(A,2)-1 means solution wla column shod kr saare bv hai
ZjCj=cost(bv)*A-cost
ZCj=[ZjCj;A]
simptable=array2table(ZCj);
simptable.Properties.VariableNames(1:size(ZCj,2))={'x1','x2','s1','s2','s3','Soln'};

RUN=true;
while RUN
    if any(ZjCj<0)
        fprintf('current bfs is not optimal')
        Zc=ZjCj(1:end-1) %alag se store kr lia ZjCj ko except the soln column
        [Enter_val,Pvt_Col]=min(Zc) %return value and uska index
        if all(a(:,Pvt_Col)<=0)
            error('Unbounded soln') %bcz min ratio apply nhi ho payega
        else
            sol=A(:,end) %sol wala/basis wale mei divide kroge na to find the min ratio
            column=A(:,Pvt_Col)
            for i=1:size(A,1)
                if column(i)>0 %upar tha ki sb ka sb -ve hai yaha jo positive eleemnt hai pivot col mei hai bs uska division kro woh kr rhe 
                  ratio(i)=sol(i)./column(i) %individually elements ko div kr rhe so ./ kra hai yaha
                else
                  ratio(i)=inf %agr div nhi ho payega
                end
            end
            [leaving_val,pvt_row]=min(ratio) %basis mei jiska min value aaya woh hua na leaving val and uske corresponding jo row number hai
        end

        bv(pvt_row)=Pvt_Col
        pvt_key=A(pvt_row,Pvt_Col)  %key toh pvt row and pvt col ka intersection haina
        A(pvt_row,:)=A(pvt_row,:)./pvt_key
        %wrt new pivot row ham operations krte hain remember
        for i=1:size(A,1)
            if i~=pvt_row
                A(i,:)=A(i,:)-A(i,Pvt_Col).*A(pvt_row,:)
            end
        end
        ZjCj=ZjCj-ZjCj(Pvt_Col).*A(pvt_row,:) 
        
        ZCj=[ZjCj;A]
        table=array2table(ZCj)
        table.Properties.VariableNames(1:size(ZCj,2))={'x1','x2','s1','s2','s3','Soln'}
    else
        RUN=false
        fprintf('The current BFS is optimal\n')
    end
end
